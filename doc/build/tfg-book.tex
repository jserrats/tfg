%TODO

\documentclass[english,10pt]{book}

% Packages
\usepackage{times}
\usepackage{fullpage}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{longtable}
\usepackage{float}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{verbatim}
\usepackage{subfigure}
\usepackage{textcomp}
\usepackage{amsmath}
\usepackage{units}
\usepackage{framed}
\usepackage{color}
\usepackage{enumerate}
\usepackage{babel}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{paralist}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{showexpl}% already includes listings package
% The listings package defines an internal command for replacements within filenames. 
% One of these replacements replaces - with \textendash. 
% You can redefine this command to make the hyphens actual hyphens:
\makeatletter
\def\lst@filenamerpl{_\textunderscore $\textdollar}
\makeatother
\lstset{frame=shadowbox, basicstyle=\footnotesize\ttfamily, showstringspaces=false,
rulesepcolor=\color{black}, upquote=true}
% \lstset{language=bash, frame=shadowbox, basicstyle=\footnotesize, showstringspaces=false,
% rulesepcolor=\color{black}, upquote=true, }
\lstdefinestyle{scriptStyle}{
    basicstyle=\footnotesize,% control font of code
    preset=\footnotesize,% adjust font size of output
    numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=5pt,
    frame=tlbr,
    pos=r,% want output on right
%     backgroundcolor=\color{yellow!30},
    width=0.50\linewidth,
}
\lstdefinestyle{verb}{
    basicstyle=\footnotesize,% control font of code
    preset=\footnotesize,% adjust font size of output
    frame=tlbr,
    pos=r,% want output on right
%     backgroundcolor=\color{yellow!30},
    width=0.50\linewidth,
}

\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{darkblue}{rgb}{0.0,0.0,0.6}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}
\lstdefinestyle{vnuml}{
    language=XML,
    basicstyle=\footnotesize,% control font of code
    preset=\footnotesize,% adjust font size of output
    frame=tlbr,
    pos=r,% want output on right
%   backgroundcolor=\color{yellow!30},
   width=0.50\linewidth,
     columns=fullflexible,
  showstringspaces=false,
  commentstyle=\color{gray}\upshape,
  stringstyle=\color{black},
  keywordstyle=\color{darkblue},
  %keywordstyle=\color{cyan},
  morekeywords={vnuml,if,vm,version,simulation_name,global,automac,vm_mgmt,vm_defaults,
  filesystem,kernel,console,net,ipv4,route,forwarding,exec,filetree,basedir,
  shell,mem,ipv6,host,ssh_version,ssh_key,netconfig,tun_device,mng_if,xterm,user},
  emph={type,id,name,mode,mask,seq,exec_mode,root},
  emphstyle=\color{cyan}
   }
%%%%%%%%%%%%%%%%%%%%%%%%%
% BEGIN Javascript!!!!! %
%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{editorGray}{rgb}{0.95, 0.95, 0.95}
\definecolor{editorOcher}{rgb}{1, 0.5, 0} % #FF7F00 -> rgb(239, 169, 0)
\definecolor{editorGreen}{rgb}{0, 0.5, 0} % #007C00 -> rgb(0, 124, 0)
\usepackage{upquote}

\lstdefinelanguage{JavaScript}{
	morekeywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break, alert},
	morecomment=[s]{/*}{*/},
	morecomment=[l]//,
	morestring=[b]",
	morestring=[b]'
}

\lstdefinelanguage{HTML5}{
	language=html,
	sensitive=true, 
	alsoletter={<>=-},
	otherkeywords={
		% HTML tags
		<html>, <head>, <title>, </title>, <meta, />, </head>, <body>,
		<canvas, \/canvas>, <script>, </script>,<script,!>,<p>,</p>, </body>, </html>,<html,!>, <!, html>, <style>, </style>, ><
	},  
	ndkeywords={
		% General
		=,
		% HTML attributes
		charset=, id=, width=, height=,
		% CSS properties
		border:, transform:, -moz-transform:, transition-duration:, transition-property:, transition-timing-function:
	},  
	morecomment=[s]{<!--}{-->},
	tag=[s]
}


\lstdefinestyle{Javascript}{
	% Basic design
	backgroundcolor=\color{editorGray},
	basicstyle={\scriptsize\ttfamily},   
	frame=l,
	% Line numbers
	xleftmargin={0.75cm},
	numbers=left,
	stepnumber=1,
	firstnumber=1,
	numberfirstline=true,
	% Code design   
	keywordstyle=\color{blue}\bfseries,
	commentstyle=\color{darkgray}\ttfamily,
	ndkeywordstyle=\color{editorGreen}\bfseries,
	stringstyle=\color{editorOcher},
	% Code
	language=HTML5,
	alsolanguage=JavaScript,
	alsodigit={.:;},
	tabsize=2,
	showtabs=false,
	showspaces=false,
	showstringspaces=false,
	extendedchars=true,
	breaklines=true,        
	% Support for German umlauts
	literate=%
	{Ö}{{\"O}}1
	{Ä}{{\"A}}1
	{Ü}{{\"U}}1
	{ß}{{\ss}}1
	{ü}{{\"u}}1
	{ä}{{\"a}}1
	{ö}{{\"o}}1
}

\lstdefinestyle{JavascriptTiny}{
	% Basic design
	backgroundcolor=\color{editorGray},
	basicstyle={\tiny\ttfamily},   
	frame=l,
	% Line numbers
	xleftmargin={0.75cm},
	numbers=left,
	stepnumber=1,
	firstnumber=1,
	numberfirstline=true,
	% Code design   
	keywordstyle=\color{blue}\bfseries,
	commentstyle=\color{darkgray}\ttfamily,
	ndkeywordstyle=\color{editorGreen}\bfseries,
	stringstyle=\color{editorOcher},
	% Code
	language=HTML5,
	alsolanguage=JavaScript,
	alsodigit={.:;},
	tabsize=2,
	showtabs=false,
	showspaces=false,
	showstringspaces=false,
	extendedchars=true,
	breaklines=true,        
	% Support for German umlauts
	literate=%
	{Ö}{{\"O}}1
	{Ä}{{\"A}}1
	{Ü}{{\"U}}1
	{ß}{{\ss}}1
	{ü}{{\"u}}1
	{ä}{{\"a}}1
	{ö}{{\"o}}1
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% END: For javascript!!!!! %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\usepackage{float}
\floatstyle{plain} % optionally change the style of the new float
\newfloat{Code}{H}{myc}[chapter]
\pdfminorversion=8
%Labtel2/UPC style
% \usepackage{labtel2}
% \usepackage{UPC}
% \addto\captionsspanish{
% \renewcommand\chaptername{Practica}
% \setlength{\parindent}{0pt} }

%Exercise package
\usepackage[answerdelayed]{exercise}
\renewcommand{\ExerciseHeader}{\raggedright{\textbf{\ExerciseName\ExerciseHeaderNB
-- \ExerciseHeaderTitle\ExerciseHeaderOrigin}}}
\renewcommand{\AnswerHeader}{\medskip{\textbf{\ExerciseName\
\ExerciseHeaderNB}\smallskip}\\}
\renewcommand{\ExerciseName}{Exercise}
% Number exercises with chapter numbers.
\renewcounter{Exercise}[chapter]% Reset counter every chapter
\renewcommand{\theExercise}{~\thechapter.\arabic{Exercise}}%

%Shadowbox environment for notes JAD
\newenvironment{shadowbox}[1]%
  {
  ~\\[-0.5in]%
  \setlength\fboxsep{4pt}%
  \definecolor{shadecolor}{rgb}{0.8,0.8,0.8}%
  \begin{shaded}%
  \addtolength{\hsize}{-0.10\columnwidth}%
  {#1\\}
  }
  {
  \end{shaded}%
  \par
  }
%End Shadowbox environment for notes

%Directory definitions for .tex inputs
\newcommand{\definedir}[2]{\newcommand{#1}{#2}}
\definedir{\securitydir}{..}

% Version control command
\newcommand{\version}[2]{{\raggedright\textit{#1} -- versión #2}\\}

%Front cover page
\AtBeginDocument{
  \def\labelitemiii{\normalfont\bfseries{--}}
}
\makeatletter
\def\thickhrulefill{\leavevmode \leaders \hrule height 1pt\hfill \kern \z@}
\def\textoA#1{\def\@textoA{#1}}
\def\textoB#1{\def\@textoB{#1}}
\def\maketitle{%
  \null
  \thispagestyle{empty}%
  {\large \raggedleft \@textoA\par}
  \vfill
  \begin{center}\leavevmode
    \normalfont
    {\LARGE\raggedleft \@author\par}%
    \thickhrulefill\par
    {\huge\raggedright \@title\par}%
    \vskip 1cm
  \end{center}%
  \vfill
  {\large \@textoB\par}
  \null

\clearpage
  }
\makeatother
\textoA {Jose L. Muñoz\\
Juanjo Alins \\ Jorge Mata \\ Oscar Esparza}
\textoB {}
\author{UPC Telematics Department}
\title{Linux Networks}
%\title{Internet Protocol}
\date{}
%End of Front cover page

% Definitions of includes with if
\newif\ifPROF
\newif\ifEXTRA
\newif\ifEXTRAEXTRA
\newif\ifSOLS
% \PROFtrue
% \EXTRAtrue
% \EXTRAEXTRAtrue
\SOLStrue

    
\begin{document}
\maketitle
\pagestyle{empty}

% \input{svn_version.tex}

\setcounter{tocdepth}{2}
\addtocontents{toc}{\protect\thispagestyle{empty}}
\tableofcontents
\pagestyle{plain}


\chapter{Basic Crypto with JS \label{chap:basic-crypto-js}}

%%%%%%%%%% symmetric crypto %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/basicJsCrypto/theory/symmetricJSCrypto}
\subsection{Practices}
\input{\securitydir/basicJsCrypto/practs/symmetricJSCrypto}

%%%%%%%%% asymmetric crypto %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/basicJsCrypto/theory/asymmetricJSCrypto}
\subsection{Practices}
\input{\securitydir/basicJsCrypto/practs/asymmetricJSCrypto}

%%%%%%%%%% hash fucntions %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/basicJsCrypto/theory/hashJSCrypto}
\subsection{Practices}
\input{\securitydir/basicJsCrypto/practs/hashJSCrypto}

\section{Projects}
\subsection{Practices}
\input{\securitydir/basicJsCrypto/practs/authenticator}
\input{\securitydir/basicJsCrypto/practs/crypto-proxy}
\input{\securitydir/basicJsCrypto/practs/crypto-socket-with-authenticator}



\chapter{Web protocols\label{chap:web-protocols}}
%%%%%% http%%%%%%%%%%
\input{\securitydir/WebProtocols/theory/http}
\subsection{Practices}
\input{\securitydir/WebProtocols/practs/http}
%%%% https %%%%%%%%
\input{\securitydir/WebProtocols/theory/https}

\chapter{Basics of Web security\label{chap:web-sec}}

%%%%%%%%%% cookies %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/WebSec/theory/cookies}

%%%%%%%%%% csrf %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/WebSec/theory/csrf}
\subsection{Practices - CSRF}
\input{\securitydir/WebSec/practs/csrf-practs}

%%%%%%%%%% xss types %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/WebSec/theory/xss-types}
\subsection{Practices - Types  of XSS}
\input{\securitydir/WebSec/practs/xsspracts-types}

%%%%%%%%%% xss attack %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/WebSec/theory/xss-attacks}


%%%%%%%%%% xss prevention %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{\securitydir/WebSec/theory/xss-prevention}
\subsection{Practices - Prevention of XSS}
\input{\securitydir/WebSec/practs/xsspracts-prevention}

%%%%%%%% xss game %%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Final practice - XSS game}
\input{\securitydir/WebSec/practs/xsspracts-game}

\ifSOLS
\chapter{Answers to Practices}
\shipoutExercise
\vspace{0.5cm}
\shipoutAnswer
\fi

% %afegit
\bibliographystyle{unsrt}
%\bibliography{\linuxdir/processes/bib/rfc.bib}
% \bibliography{\linuxdir/processes/bib/rfc,....}
% %fi

\end{document}
